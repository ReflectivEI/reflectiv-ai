<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Live Sales Coach Multi-turn Tests</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta http-equiv="refresh" content="30" />
<style>
 body { font-family: system-ui, monospace; margin: 1rem 2rem; }
 h1 { margin-top: 0; }
 #raw { white-space: pre-wrap; font-family: monospace; background:#f7f7f7; padding:1rem; border:1px solid #ddd; max-height:60vh; overflow:auto; }
 .status-ok { color: #0a0; }
 .status-error { color: #c00; }
 .badge { padding:2px 6px; border-radius:4px; font-size:0.75rem; background:#222; color:#fff; }
</style>
</head>
<body>
<h1>Live Sales Coach Multi-turn Tests</h1>
<p>Auto-updating panel (refresh every 30s). Source: <code>watch_sales_coach_tests.sh</code></p>
<p>Latest run: <span id="ts">(loading)</span> | Status: <span id="status" class="badge">...</span></p>
<details open>
  <summary><strong>Parsed Checks</strong></summary>
  <ul id="checks">
    <li>Loading...</li>
  </ul>
</details>
<details>
  <summary><strong>Raw Output</strong></summary>
  <div id="raw">Loading raw output...</div>
</details>
<script>
async function load(){
  try {
    const j = await fetch('live_sales_coach_tests.json?cb=' + Date.now());
    if(!j.ok) return;
    const data = await j.json();
    document.getElementById('ts').textContent = data.timestamp;
    const statusEl = document.getElementById('status');
    statusEl.textContent = data.status;
    statusEl.className = 'badge status-' + data.status;
    document.getElementById('raw').textContent = data.raw;
    // Basic parser checks
    const checks = [];
    const raw = data.raw;
    function has(label){ return raw.includes(label); }
    checks.push(has('Suggested Phrasing') ? 'Suggested Phrasing: present' : 'Suggested Phrasing: MISSING');
    checks.push(has('<coach>') ? '<coach> tag present' : '<coach> tag MISSING');
    checks.push(has('Coaching Guidance') ? 'Coaching Guidance section present' : 'Coaching Guidance section MISSING');
    checks.push(/\bTurn\s*1\b/i.test(raw) ? 'Turn markers detected' : 'Turn markers NOT detected');
    const ul = document.getElementById('checks');
    ul.innerHTML = '';
    for(const c of checks){
      const li = document.createElement('li');
      li.textContent = c;
      ul.appendChild(li);
    }
  } catch(e){
    console.error(e);
  }
}
load();
setInterval(load, 15000);
</script>
</body>
</html>